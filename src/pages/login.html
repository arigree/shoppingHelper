<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>Login â€” Sustainable Shopping</title>
    <link rel="stylesheet" href="/src/style.css" />
  </head>
  <body>
    <div class="auth-card">
      <h2>Log In</h2>

      <input id="email" type="email" placeholder="Email" />
      <input id="password" type="password" placeholder="Password" />

      <div
        style="
          display: flex;
          gap: 10px;
          justify-content: center;
          margin-top: 10px;
        "
      >
        <button id="loginBtn" class="btn btn-secondary">Login</button>
        <a
          href="/"
          class="btn btn-ghost"
          style="
            text-decoration: none;
            display: inline-flex;
            align-items: center;
          "
          >Cancel</a
        >
      </div>

      <p style="margin-top: 14px">
        Don't have an account? <a href="/src/pages/signup.html">Sign up</a>
      </p>
      <div id="status" class="status"></div>
    </div>

    <script type="module">
      import { login, onAuthChange } from "/src/authHelpers.js";

      const emailEl = document.getElementById("email");
      const passEl = document.getElementById("password");
      const btn = document.getElementById("loginBtn");
      const status = document.getElementById("status");

      btn.addEventListener("click", async () => {
        status.textContent = "";
        btn.disabled = true;
        try {
          await login(emailEl.value.trim(), passEl.value);
          // success = auth listener below redirect
        } catch (err) {
          status.textContent = err.message;
          btn.disabled = false;
        }
      });

      // If already signed in, go home immediately
      onAuthChange((user) => {
        if (user) window.location.href = "/";
      });
    </script>
  </body>
</html>
